<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>⛔️ Async Error Handling di TypeScript | Radito's Blog</title><meta name=keywords content><meta name=description content="Pada project yang menggunakan bahasa Typescript atau Javascript modern, penggunaan promise dan sistem asinkronus sudah banyak digunakan secara umum. Fitur asinkron dalam pemrograman memungkinkan eksekusi beberapa tugas secara bersamaan tanpa harus menunggu tugas satu selesai sebelum tugas lainnya dimulai.
Dalam konteks JavaScript dan TypeScript, salah cara utama untuk mengelola operasi asinkron adalah menggunakan Promise. Promise adalah objek yang merepresentasikan nilai yang mungkin akan tersedia di masa depan, atau mungkin tidak tersedia sama sekali."><meta name=author content="Me"><link rel=canonical href=https://radito.github.io/posts/47d0b04e-76e1-49d5-ad42-c083c8c1eb52/><meta name=google-site-verification content="hIJuohE4d1PONV6JA6mcxg6VkWOuSYk0kAxTWXBy9bg"><script>window.addEventListener("load",function(){const e=document.createElement("script");e.type="text/javascript",e.src="https://www.googletagmanager.com/gtag/js?id=G-T5BM0HNNW0",e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-T5BM0HNNW0")},document.head.appendChild(e)})</script><link rel=preload href=https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v2.8.9/dist/cookieconsent.css as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v2.8.9/dist/cookieconsent.css media=print onload='this.media="all"'><link crossorigin=anonymous href=/assets/css/stylesheet.ab1772dff0b40d52d92563b27000ca455842e91c0e47bddcdd8538d5b29a9bb7.css integrity="sha256-qxdy3/C0DVLZJWOycADKRVhC6RwOR73c3YU41bKam7c=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon-32x32.png><link rel=apple-touch-icon href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/apple-touch-icon.png><link rel=mask-icon href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/apple-touch-icon.png><meta name=theme-color content=" #2e2e33"><meta name=msapplication-TileColor content=" #2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>img[loading=lazy]{margin-left:auto;margin-right:auto}code{max-height:650px}code::-webkit-scrollbar{width:10px}img:hover{cursor:zoom-in}.viewer-close{background-color:transparent!important;border:0!important;box-shadow:none!important}</style><meta property="og:title" content="⛔️ Async Error Handling di TypeScript"><meta property="og:description" content="Pada project yang menggunakan bahasa Typescript atau Javascript modern, penggunaan promise dan sistem asinkronus sudah banyak digunakan secara umum. Fitur asinkron dalam pemrograman memungkinkan eksekusi beberapa tugas secara bersamaan tanpa harus menunggu tugas satu selesai sebelum tugas lainnya dimulai.
Dalam konteks JavaScript dan TypeScript, salah cara utama untuk mengelola operasi asinkron adalah menggunakan Promise. Promise adalah objek yang merepresentasikan nilai yang mungkin akan tersedia di masa depan, atau mungkin tidak tersedia sama sekali."><meta property="og:type" content="article"><meta property="og:url" content="https://radito.github.io/posts/47d0b04e-76e1-49d5-ad42-c083c8c1eb52/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-30T05:20:00+00:00"><meta property="article:modified_time" content="2023-12-30T05:20:00+00:00"><meta property="og:site_name" content="Radito's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="⛔️ Async Error Handling di TypeScript"><meta name=twitter:description content="Pada project yang menggunakan bahasa Typescript atau Javascript modern, penggunaan promise dan sistem asinkronus sudah banyak digunakan secara umum. Fitur asinkron dalam pemrograman memungkinkan eksekusi beberapa tugas secara bersamaan tanpa harus menunggu tugas satu selesai sebelum tugas lainnya dimulai.
Dalam konteks JavaScript dan TypeScript, salah cara utama untuk mengelola operasi asinkron adalah menggunakan Promise. Promise adalah objek yang merepresentasikan nilai yang mungkin akan tersedia di masa depan, atau mungkin tidak tersedia sama sekali."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://radito.github.io/posts/"},{"@type":"ListItem","position":2,"name":"⛔️ Async Error Handling di TypeScript","item":"https://radito.github.io/posts/47d0b04e-76e1-49d5-ad42-c083c8c1eb52/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"⛔️ Async Error Handling di TypeScript","name":"⛔️ Async Error Handling di TypeScript","description":"Pada project yang menggunakan bahasa Typescript atau Javascript modern, penggunaan promise dan sistem asinkronus sudah banyak digunakan secara umum. Fitur asinkron dalam pemrograman memungkinkan eksekusi beberapa tugas secara bersamaan tanpa harus menunggu tugas satu selesai sebelum tugas lainnya dimulai.\nDalam konteks JavaScript dan TypeScript, salah cara utama untuk mengelola operasi asinkron adalah menggunakan Promise. Promise adalah objek yang merepresentasikan nilai yang mungkin akan tersedia di masa depan, atau mungkin tidak tersedia sama sekali.","keywords":[],"articleBody":"Pada project yang menggunakan bahasa Typescript atau Javascript modern, penggunaan promise dan sistem asinkronus sudah banyak digunakan secara umum. Fitur asinkron dalam pemrograman memungkinkan eksekusi beberapa tugas secara bersamaan tanpa harus menunggu tugas satu selesai sebelum tugas lainnya dimulai.\nDalam konteks JavaScript dan TypeScript, salah cara utama untuk mengelola operasi asinkron adalah menggunakan Promise. Promise adalah objek yang merepresentasikan nilai yang mungkin akan tersedia di masa depan, atau mungkin tidak tersedia sama sekali. Ide dasar di balik Promise adalah bahwa suatu operasi asinkron dapat memiliki dua hasil: berhasil atau gagal.\nPada artikel ini, akan dibahas konsep untuk error handling dalam kode asinkronus menggunakan TypeScript. Pada implementasinya akan menggunakan async/await untuk membuat kode lebih mudah dibaca dan strategi untuk menangani kesalahan yang muncul selama operasi asinkron.\nKode Error Handling type TryPromiseReturn\u003cT, U\u003e = Promise\u003c[U, undefined] | [null, T]\u003e; function tryPromise\u003cT, U extends Error\u003e(promiseHandle: Promise\u003cT\u003e): TryPromiseReturn\u003cT, U\u003e { return promiseHandle .then\u003c[null, T]\u003e((data: T) =\u003e [null, data]) .catch\u003c[U, undefined]\u003e((err: U) =\u003e [err, undefined]); } export { tryPromise }; Kode diatas merupakan function di typescript yang digunakan untuk mengatasi error. Pada function diatas didefinisikan tryPromise dengan parameter Promise dengan tipe generic sehingga dapat menerima semua return type promise yang dimasukkan pada parameternya.\nKemudian di dalam function tryPromise dilakukan handling promise seperti pada biasanya menggunakan callback then dan catch, callback then digunakan ketika promise berhasil dijalankan dan tidak ada error di dalamnya. Callback ini menggunakan paramter data dengan tipe generic turunan dari argument Promise sehingga tipenya akan sama dengan return dari hasil promiseHandle.\nJika promise berhasil maka akan dikembalikan keluaran berbentuk array format array dengan hasil kembalian seperti dibawah\n→ Kondisi sukses\n[error: null, data: ...]\n→ Kondisi Error\n[error: ..., data:null]\nData merupakan array dengan index ke [1] sedangkan error berada pada array dengan index ke [0] dengan struktur seperti diatas dengan mudah data array dapat dilakukan destructuring menggunakan fungsi destruktur array pada javascript dan dapat langsung disimpan pada variable yang akan digunakan.\nPenggunaan Kode Ada skenario dimana sebuah program melakukan request ke external API untuk mendapatkan data json. Pada proses yang dijalankan banyak sekali error yang akan dihadapi maupun error yang tidak terduga yang dapat terjadi sewaktu waktu seperti:\nKoneksi gagal sehingga request tidak terkirim HTTP 500 Internal Server Error Gateway Timeout Invalid Json dll → Handling error menggunakan Try Catch ❌\nimport { tryPromise } from \"../../lib/utils/helpers\"; async function fetchData(query: string): Promise\u003cobject | null\u003e { const fetchUrl = `/api/data?q=${encodeURIComponent(query)}`; let fetchJson = null; try { const fetchCtx = await fetch(fetchUrl, { method: \"GET\", mode: \"cors\", credentials: \"include\", body: null, }); if (!fetchCtx.ok) { const fetchStatus = fetchCtx.statusText; console.log(fetchStatus); return null; } fetchJson = await fetchCtx.json(); } catch (err) { console.log(err); } return fetchJson; } Penggunaan error handling menggunakan try catch hasilnya akan mengcover seluruh blok pada kode. Dengan menggunakan try catch kita dipaksa untuk memasukkan seluruh blok kode di dalam statement tersebut akhirnya kode yang dihasilkan menjadi susah untuk dimaintain dan susah untuk dibaca, karena bisa saja error terjadi di bagian kode mana saja dan tidak ada handling spesifik untuk function tertentu.\n→ Handling error menggunakan tryPromise ✅\nimport { tryPromise } from \"../../lib/utils/helpers\"; async function fetchData(query: string): Promise\u003cobject | null\u003e { const fetchUrl = `/api/data?q=${encodeURIComponent(query)}`; const [errFetchCtx, fetchCtx] = await tryPromise( fetch(fetchUrl, { method: \"GET\", mode: \"cors\", credentials: \"include\", body: null, }) ); if (errFetchCtx) { console.log(\"Error when executing fetch \", errFetchCtx); return null; } if (!fetchCtx.ok) { const fetchStatus = fetchCtx.statusText; console.log(fetchStatus); return null; } const [errFetchJson, fetchJson] = await tryPromise(fetchCtx.json()); if (errFetchJson) { console.log(\"Error when parsing JSON response\"); return null; } return fetchJson; } Jika function tryPromise digunakan, maka handling error dapat dilakukan pada setiap function yang akan dipanggil. Sehingga kode yang ditulis akan mudah terbaca, selain itu akan terlihat jelas dimana function tersebut dipanggil dan dimana error dari function tersebut akan terjadi.\nSehingga kita tidak perlu memasukkan seluruh blok kode ke dalam function try catch hanya untuk menghandle satu error yang ada pada function, serta kondisi error handling tiap promise dapat berbeda beda dan bisa disesuaikan sesuai kebutuhan apakah error tersebut perlu penanganan lanjutan pada saat pengecekannya.\nPenutup Ada banyak cara untuk menangani error pada program, entah itu error atau tidak karena hanya programmer yang dapat mendefinisikannya. Pada sejatinya error adalah sebuah value / nilai dan sebagai programmer adalah bagaimana kita menangani error tersebut atau mengabaikannya. Untuk solusi tryPromise memang banyak terinsipirasi dari penanganan error dari bahasa Go karena dalam Golang penanganan error merupakan hal yang dibuat secara simple tidak perlu membutuhkan blok penanganan yang lebih lanjut. Error pada golang dihandle layaknya variable adalah sebuah nilai yang di definisikan oleh programmer.\nTidak ada cara yang sepenuhnya benar untuk menangani error, penggunaan try catch akan lebih sesuai pada use case tertentu sehingga penggunaan tryPromise malah akan mempersulit. Oleh karena itu, gunakanlah cara dan metode sesuai kebuhan anda.\nReferensi https://go.dev/blog/error-handling-and-go\nhttps://github.com/scopsy/await-to-js\n","wordCount":"791","inLanguage":"en","datePublished":"2023-12-30T05:20:00Z","dateModified":"2023-12-30T05:20:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://radito.github.io/posts/47d0b04e-76e1-49d5-ad42-c083c8c1eb52/"},"publisher":{"@type":"Organization","name":"Radito's Blog","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon.ico"}}}</script><script defer src=https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@latest/dist/cookieconsent.js></script>
<script>window.addEventListener("load",async function(){await new Promise(e=>setTimeout(e,3e3));var e=initCookieConsent();e.run({current_lang:"en",autoclear_cookies:!0,page_scripts:!0,onFirstAction:function(){},onAccept:function(){},onChange:function(){},languages:{en:{consent_modal:{title:"🍪 We use cookies!",description:'Hi, this website uses essential cookies to ensure its proper operation and tracking cookies to understand how you interact with it. The latter will be set only after consent. <button type="button" data-cc="c-settings" class="cc-link">Let me choose</button>',primary_btn:{text:"✅ Accept all",role:"accept_all"},secondary_btn:{text:"❌ Reject all",role:"accept_necessary"}},settings_modal:{title:"Cookie preferences",save_settings_btn:"Save settings",accept_all_btn:"Accept all",reject_all_btn:"Reject all",close_btn_label:"Close",cookie_table_headers:[{col1:"Name"},{col2:"Domain"},{col3:"Expiration"},{col4:"Description"}],blocks:[{title:"Cookie usage 📢",description:"I use cookies to ensure the basic functionalities of the website and to enhance your online experience. You can choose for each category to opt-in/out whenever you want."},{title:"Strictly necessary cookies",description:"These cookies are essential for the proper functioning of my website. Without these cookies, the website would not work properly",toggle:{value:"necessary",enabled:!0,readonly:!0}},{title:"Performance and Analytics cookies",description:"These cookies allow the website to remember the choices you have made in the past",toggle:{value:"analytics",enabled:!0,readonly:!1},cookie_table:[{col1:"^_ga",col2:"google.com",col3:"2 years",col4:"Google Analytics Cookie",is_regex:!0}]}]}}}})})</script><script>function setSyntaxMode(e){const t=document.querySelectorAll("pre.chroma");e=="dark"&&t.forEach((e)=>{e.classList.remove("theme-github-min"),e.classList.add("theme-github-dark-dimmed-min")}),e=="light"&&t.forEach((e)=>{e.classList.add("theme-github-min"),e.classList.remove("theme-github-dark-dimmed-min")})}</script><script>const currentLocal=localStorage.getItem("pref-theme");!currentLocal&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(localStorage.setItem("pref-theme","dark"),document.documentElement.classList.add("c_darkmode")),currentLocal=="dark"&&document.documentElement.classList.add("c_darkmode"),window.addEventListener("load",function(){document.getElementById("theme-toggle").addEventListener("click",async()=>{await new Promise(e=>setTimeout(e,100));const e=localStorage.getItem("pref-theme");setSyntaxMode(e),e=="dark"?document.documentElement.classList.add("c_darkmode"):document.documentElement.classList.remove("c_darkmode")})})</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://radito.github.io/ accesskey=h title="Radito's Blog (Alt + H)">Radito's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://radito.github.io/ title=Home><span>Home</span></a></li><li><a href=https://radito.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://radito.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><link rel=preload href=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.css as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.css><link href=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.js rel=preload as=script><script defer src=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.js></script>
<script type=application/ld+json class=reviews-schema data-ref=007f0ae2bb9d00a2d8ed8ca3e458d83b>{"@context":"http://schema.org","@type":"Product","name":"Embed Social","aggregateRating":{"@type":"AggregateRating","ratingValue":"5","reviewCount":"100"}}</script><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://radito.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://radito.github.io/posts/>Posts</a></div><h1 class=post-title>⛔️ Async Error Handling di TypeScript</h1><div class=post-meta><span title='2023-12-30 05:20:00 +0000 UTC'>December 30, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;791 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/radito/radito.github.io/blob/main/content/posts/47d0b04e-76e1-49d5-ad42-c083c8c1eb52.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Pada project yang menggunakan bahasa Typescript atau Javascript modern, penggunaan promise dan sistem asinkronus sudah banyak digunakan secara umum. Fitur asinkron dalam pemrograman memungkinkan eksekusi beberapa tugas secara bersamaan tanpa harus menunggu tugas satu selesai sebelum tugas lainnya dimulai.</p><p>Dalam konteks JavaScript dan TypeScript, salah cara utama untuk mengelola operasi asinkron adalah menggunakan Promise. Promise adalah objek yang merepresentasikan nilai yang mungkin akan tersedia di masa depan, atau mungkin tidak tersedia sama sekali. Ide dasar di balik Promise adalah bahwa suatu operasi asinkron dapat memiliki dua hasil: berhasil atau gagal.</p><p>Pada artikel ini, akan dibahas konsep untuk error handling dalam kode asinkronus menggunakan TypeScript. Pada implementasinya akan menggunakan <code>async/await</code> untuk membuat kode lebih mudah dibaca dan strategi untuk menangani kesalahan yang muncul selama operasi asinkron.</p><h3 id=kode-error-handling>Kode Error Handling<a hidden class=anchor aria-hidden=true href=#kode-error-handling>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TryPromiseReturn</span><span class=p>&lt;</span><span class=nt>T</span><span class=err>,</span> <span class=na>U</span><span class=p>&gt;</span> <span class=o>=</span> <span class=nx>Promise</span><span class=o>&lt;</span><span class=p>[</span><span class=nx>U</span><span class=p>,</span> <span class=kc>undefined</span><span class=p>]</span> <span class=o>|</span> <span class=p>[</span><span class=kc>null</span><span class=p>,</span> <span class=nx>T</span><span class=p>]</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>tryPromise</span><span class=p>&lt;</span><span class=nt>T</span><span class=err>,</span> <span class=na>U</span> <span class=na>extends</span> <span class=na>Error</span><span class=p>&gt;(</span><span class=nx>promiseHandle</span>: <span class=kt>Promise</span><span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;)</span><span class=o>:</span> <span class=nx>TryPromiseReturn</span><span class=p>&lt;</span><span class=nt>T</span><span class=err>,</span> <span class=na>U</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>promiseHandle</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>then</span><span class=o>&lt;</span><span class=p>[</span><span class=kc>null</span><span class=p>,</span> <span class=nx>T</span><span class=p>]</span><span class=o>&gt;</span><span class=p>((</span><span class=nx>data</span>: <span class=kt>T</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=kc>null</span><span class=p>,</span> <span class=nx>data</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=k>catch</span><span class=o>&lt;</span><span class=p>[</span><span class=nx>U</span><span class=p>,</span> <span class=kc>undefined</span><span class=p>]</span><span class=o>&gt;</span><span class=p>((</span><span class=nx>err</span>: <span class=kt>U</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>err</span><span class=p>,</span> <span class=kc>undefined</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=p>{</span> <span class=nx>tryPromise</span> <span class=p>};</span>
</span></span></code></pre></div><p>Kode diatas merupakan function di typescript yang digunakan untuk mengatasi error. Pada function diatas didefinisikan <code>tryPromise</code> dengan parameter <code>Promise&lt;T></code> dengan tipe generic sehingga dapat menerima semua return type promise yang dimasukkan pada parameternya.</p><p>Kemudian di dalam function <code>tryPromise</code> dilakukan handling promise seperti pada biasanya menggunakan callback then dan catch, callback then digunakan ketika promise berhasil dijalankan dan tidak ada error di dalamnya. Callback ini menggunakan paramter data dengan tipe generic turunan dari argument <code>Promise&lt;T></code> sehingga tipenya akan sama dengan return dari hasil promiseHandle.</p><p>Jika promise berhasil maka akan dikembalikan keluaran berbentuk array format array dengan hasil kembalian seperti dibawah</p><p>→ Kondisi sukses</p><p><code>[error: null, data: ...]</code></p><p>→ Kondisi Error</p><p><code>[error: ..., data:null]</code></p><p>Data merupakan array dengan index ke [1] sedangkan error berada pada array dengan index ke [0] dengan struktur seperti diatas dengan mudah data array dapat dilakukan destructuring menggunakan fungsi destruktur array pada javascript dan dapat langsung disimpan pada variable yang akan digunakan.</p><h3 id=penggunaan-kode>Penggunaan Kode<a hidden class=anchor aria-hidden=true href=#penggunaan-kode>#</a></h3><p>Ada skenario dimana sebuah program melakukan request ke external API untuk mendapatkan data json. Pada proses yang dijalankan banyak sekali error yang akan dihadapi maupun error yang tidak terduga yang dapat terjadi sewaktu waktu seperti:</p><ul><li>Koneksi gagal sehingga request tidak terkirim</li><li>HTTP 500 Internal Server Error</li><li>Gateway Timeout</li><li>Invalid Json</li><li>dll</li></ul><p>→ Handling error menggunakan Try Catch ❌</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>tryPromise</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;../../lib/utils/helpers&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fetchData</span><span class=p>(</span><span class=nx>query</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>object</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>fetchUrl</span> <span class=o>=</span> <span class=sb>`/api/data?q=</span><span class=si>${</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>query</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>fetchJson</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>fetchCtx</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>fetchUrl</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s2>&#34;GET&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>mode</span><span class=o>:</span> <span class=s2>&#34;cors&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>credentials</span><span class=o>:</span> <span class=s2>&#34;include&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span>: <span class=kt>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>fetchCtx</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>fetchStatus</span> <span class=o>=</span> <span class=nx>fetchCtx</span><span class=p>.</span><span class=nx>statusText</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>fetchStatus</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>fetchJson</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>fetchCtx</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>fetchJson</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Penggunaan error handling menggunakan try catch hasilnya akan mengcover seluruh blok pada kode. Dengan menggunakan try catch kita dipaksa untuk memasukkan seluruh blok kode di dalam statement tersebut akhirnya kode yang dihasilkan menjadi susah untuk dimaintain dan susah untuk dibaca, karena bisa saja error terjadi di bagian kode mana saja dan tidak ada handling spesifik untuk function tertentu.</p><p>→ Handling error menggunakan tryPromise ✅</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>tryPromise</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;../../lib/utils/helpers&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fetchData</span><span class=p>(</span><span class=nx>query</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>object</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>fetchUrl</span> <span class=o>=</span> <span class=sb>`/api/data?q=</span><span class=si>${</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>query</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>errFetchCtx</span><span class=p>,</span> <span class=nx>fetchCtx</span><span class=p>]</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>tryPromise</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>fetch</span><span class=p>(</span><span class=nx>fetchUrl</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>method</span><span class=o>:</span> <span class=s2>&#34;GET&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>mode</span><span class=o>:</span> <span class=s2>&#34;cors&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>credentials</span><span class=o>:</span> <span class=s2>&#34;include&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>body</span>: <span class=kt>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>errFetchCtx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Error when executing fetch &#34;</span><span class=p>,</span> <span class=nx>errFetchCtx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>fetchCtx</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>fetchStatus</span> <span class=o>=</span> <span class=nx>fetchCtx</span><span class=p>.</span><span class=nx>statusText</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>fetchStatus</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>errFetchJson</span><span class=p>,</span> <span class=nx>fetchJson</span><span class=p>]</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>tryPromise</span><span class=p>(</span><span class=nx>fetchCtx</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>errFetchJson</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Error when parsing JSON response&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>fetchJson</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Jika function tryPromise digunakan, maka handling error dapat dilakukan pada setiap function yang akan dipanggil. Sehingga kode yang ditulis akan mudah terbaca, selain itu akan terlihat jelas dimana function tersebut dipanggil dan dimana error dari function tersebut akan terjadi.</p><p>Sehingga kita tidak perlu memasukkan seluruh blok kode ke dalam function try catch hanya untuk menghandle satu error yang ada pada function, serta kondisi error handling tiap promise dapat berbeda beda dan bisa disesuaikan sesuai kebutuhan apakah error tersebut perlu penanganan lanjutan pada saat pengecekannya.</p><h3 id=penutup>Penutup<a hidden class=anchor aria-hidden=true href=#penutup>#</a></h3><p>Ada banyak cara untuk menangani error pada program, entah itu error atau tidak karena hanya programmer yang dapat mendefinisikannya. Pada sejatinya error adalah sebuah value / nilai dan sebagai programmer adalah bagaimana kita menangani error tersebut atau mengabaikannya. Untuk solusi tryPromise memang banyak terinsipirasi dari penanganan error dari bahasa Go karena dalam Golang penanganan error merupakan hal yang dibuat secara simple tidak perlu membutuhkan blok penanganan yang lebih lanjut. Error pada golang dihandle layaknya variable adalah sebuah nilai yang di definisikan oleh programmer.</p><p>Tidak ada cara yang sepenuhnya benar untuk menangani error, penggunaan try catch akan lebih sesuai pada use case tertentu sehingga penggunaan tryPromise malah akan mempersulit. Oleh karena itu, gunakanlah cara dan metode sesuai kebuhan anda.</p><h3 id=referensi>Referensi<a hidden class=anchor aria-hidden=true href=#referensi>#</a></h3><p><a href=https://go.dev/blog/error-handling-and-go>https://go.dev/blog/error-handling-and-go</a></p><p><a href=https://github.com/scopsy/await-to-js>https://github.com/scopsy/await-to-js</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://radito.github.io/posts/6b0dfa39-35a9-4af5-b2e9-ded176981f46/><span class=title>Next »</span><br><span>🔄 Restart Modem Bolt BL-100 (OpenWRT)</span></a></nav></footer><div id=comments class=thin issue-term="Blog Post - ⛔️ Async Error Handling di TypeScript" style="background-color:var(--code-bg);border:1px solid var(--border);border-radius:var(--radius);padding:0 1rem"><center id=loading-comments><p style="margin:.5rem 0">Loading Comments ...</p></center></div></article><script>const utterances=document.createElement("script");utterances.src=`https://utteranc.es/client.js`,utterances.setAttribute("repo","radito/radito.github.io"),utterances.setAttribute("issue-term",""),utterances.setAttribute("theme",""),utterances.setAttribute("crossorigin","anonymous"),utterances.async=!0,window.addEventListener("load",function(){document.querySelectorAll("img").forEach((e)=>{const n=new Viewer(e,{movable:!1,navbar:!1,toolbar:!1,focus:!0,transition:!1});e.addEventListener("show",function(){document.getElementsByTagName("html")[0].style.overflow="hidden"}),e.addEventListener("hide",function(){document.getElementsByTagName("html")[0].style.overflow="scroll"})})}),document.getElementById("theme-toggle").addEventListener("click",async()=>{const e=localStorage.getItem("pref-theme"),t=document.querySelector(".utterances-frame");if(e=="light"?(setSyntaxMode("dark"),document.documentElement.classList.remove("c_darkmode")):(setSyntaxMode("light"),document.documentElement.classList.remove("c_darkmode"),document.documentElement.classList.add("c_darkmode")),t){const n={type:"set-theme",theme:e=="light"?"github-dark":"github-light"};t.contentWindow.postMessage(n,"https://utteranc.es")}}),window.onload=async()=>{const e=localStorage.getItem("pref-theme"),t=document.getElementById("comments"),n=t.getAttribute("issue-term"),s=document.getElementById("loading-comments");setSyntaxMode(e),utterances.setAttribute("theme",`github-${e??"light"}`),utterances.setAttribute("issue-term",n),window.addEventListener("message",function(e){new URL(e?.origin).host=="utteranc.es"&&s.remove()}),t.appendChild(utterances)}</script></main><footer class=footer><span>&copy; 2024 <a href=https://radito.github.io/>Radito's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>