<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>🔐 Implementasi HMAC di ESP32 / ESP8266 | Radito's Blog</title><meta name=keywords content><meta name=description content="Hash Message Authentication Code (HMAC) adalah sebuah kode yang digunakan untuk mengautentikasi keaslian pesan yang dikirimkan dari sebuah klien menuju server atau sebaliknya. HMAC. Pengguaan HMAC didasari dengan penggunaan Secret key yang disetujui antara klien dan server, serta payload adalah masukan yang digunakan untuk menghitung HASH hasil hmac.
Algoritma hash yang digunakan HMAC bervariasi, tetapi kebanyakan menggunakan algoritma SHA1 atau SHA256. Berikut ini adalah ilustrasi penggunaan HMAC antar klien dan server."><meta name=author content="Me"><link rel=canonical href=https://radito.github.io/posts/aa56eb07-4f2d-47b4-bb88-3b4bb72ca41d/><meta name=google-site-verification content="hIJuohE4d1PONV6JA6mcxg6VkWOuSYk0kAxTWXBy9bg"><script defer src="https://www.googletagmanager.com/gtag/js?id=G-T5BM0HNNW0"></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v2.8.9/dist/cookieconsent.css media=print onload='this.media="all"'><link crossorigin=anonymous href=/assets/css/stylesheet.e71a98a2076ffd6b14e484f3a664a3bdf0c5721ff2740c6a01905a1bfd8641a0.css integrity="sha256-5xqYogdv/WsU5ITzpmSjvfDFch/ydAxqAZBaG/2GQaA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon-32x32.png><link rel=apple-touch-icon href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/apple-touch-icon.png><link rel=mask-icon href=https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/apple-touch-icon.png><meta name=theme-color content=" #2e2e33"><meta name=msapplication-TileColor content=" #2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>img[loading=lazy]{margin-left:auto;margin-right:auto}code{max-height:650px}code::-webkit-scrollbar{width:10px}img:hover{cursor:zoom-in}.viewer-close{background-color:transparent!important;border:0!important;box-shadow:none!important}</style><meta property="og:title" content="🔐 Implementasi HMAC di ESP32 / ESP8266"><meta property="og:description" content="Hash Message Authentication Code (HMAC) adalah sebuah kode yang digunakan untuk mengautentikasi keaslian pesan yang dikirimkan dari sebuah klien menuju server atau sebaliknya. HMAC. Pengguaan HMAC didasari dengan penggunaan Secret key yang disetujui antara klien dan server, serta payload adalah masukan yang digunakan untuk menghitung HASH hasil hmac.
Algoritma hash yang digunakan HMAC bervariasi, tetapi kebanyakan menggunakan algoritma SHA1 atau SHA256. Berikut ini adalah ilustrasi penggunaan HMAC antar klien dan server."><meta property="og:type" content="article"><meta property="og:url" content="https://radito.github.io/posts/aa56eb07-4f2d-47b4-bb88-3b4bb72ca41d/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-14T07:49:00+00:00"><meta property="article:modified_time" content="2023-08-14T07:49:00+00:00"><meta property="og:site_name" content="Radito's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="🔐 Implementasi HMAC di ESP32 / ESP8266"><meta name=twitter:description content="Hash Message Authentication Code (HMAC) adalah sebuah kode yang digunakan untuk mengautentikasi keaslian pesan yang dikirimkan dari sebuah klien menuju server atau sebaliknya. HMAC. Pengguaan HMAC didasari dengan penggunaan Secret key yang disetujui antara klien dan server, serta payload adalah masukan yang digunakan untuk menghitung HASH hasil hmac.
Algoritma hash yang digunakan HMAC bervariasi, tetapi kebanyakan menggunakan algoritma SHA1 atau SHA256. Berikut ini adalah ilustrasi penggunaan HMAC antar klien dan server."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://radito.github.io/posts/"},{"@type":"ListItem","position":2,"name":"🔐 Implementasi HMAC di ESP32 / ESP8266","item":"https://radito.github.io/posts/aa56eb07-4f2d-47b4-bb88-3b4bb72ca41d/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"🔐 Implementasi HMAC di ESP32 / ESP8266","name":"🔐 Implementasi HMAC di ESP32 \/ ESP8266","description":"Hash Message Authentication Code (HMAC) adalah sebuah kode yang digunakan untuk mengautentikasi keaslian pesan yang dikirimkan dari sebuah klien menuju server atau sebaliknya. HMAC. Pengguaan HMAC didasari dengan penggunaan Secret key yang disetujui antara klien dan server, serta payload adalah masukan yang digunakan untuk menghitung HASH hasil hmac.\nAlgoritma hash yang digunakan HMAC bervariasi, tetapi kebanyakan menggunakan algoritma SHA1 atau SHA256. Berikut ini adalah ilustrasi penggunaan HMAC antar klien dan server.","keywords":[],"articleBody":"Hash Message Authentication Code (HMAC) adalah sebuah kode yang digunakan untuk mengautentikasi keaslian pesan yang dikirimkan dari sebuah klien menuju server atau sebaliknya. HMAC. Pengguaan HMAC didasari dengan penggunaan Secret key yang disetujui antara klien dan server, serta payload adalah masukan yang digunakan untuk menghitung HASH hasil hmac.\nAlgoritma hash yang digunakan HMAC bervariasi, tetapi kebanyakan menggunakan algoritma SHA1 atau SHA256. Berikut ini adalah ilustrasi penggunaan HMAC antar klien dan server.\nContoh Implementasi HMAC di ESP32\n#include \"mbedtls/md.h\" #define HMAC_SECRET \"123456\" void genHmac(char* signature, char* payload) { byte hmacResult[20]; mbedtls_md_context_t ctx; mbedtls_md_type_t md_type = MBEDTLS_MD_SHA1; // Algoritma Yang dipakai SHA 1 const size_t payloadLength = strlen(payload); const size_t keyLength = strlen(HMAC_SECRET); mbedtls_md_init(\u0026ctx); mbedtls_md_setup(\u0026ctx, mbedtls_md_info_from_type(md_type), 1); mbedtls_md_hmac_starts(\u0026ctx, (const unsigned char*)HMAC_SECRET, keyLength); mbedtls_md_hmac_update(\u0026ctx, (const unsigned char*)payload, payloadLength); mbedtls_md_hmac_finish(\u0026ctx, hmacResult); mbedtls_md_free(\u0026ctx); char outDigest[45]; int count = 0; for (int i = 0; i \u003c sizeof(hmacResult); i++) { char str[3]; sprintf(str, \"%02x\", (int)hmacResult[i]); outDigest[count] = str[0]; count++; outDigest[count] = str[1]; count++; } outDigest[count] = '\\0'; strcpy(signature, outDigest); } void setup(){ char* hmacSignature[45]; char* message = \"Hello World\"; char* unixTime = \"1692003946\" char payload[128]; snprintf(payload, 128, \"%s,%s\", message, unixTime); genHmac(\u0026hmacSignature[0], payload); Serial.print(\"Generated HMAC :\"); Serial.println(hmacSignature); } Kode diatas menghasilkan kode hmac dengan menggunakan payload dan secret key yang sudah ditentukan. Antara Server dan Klien masing masing memiliki secret yang sama, secret ini di distribusikan melalui kanal yang aman atau melalui cara offline tidak menggunakan internet. Secret ini diperlukan untuk memvalidasi hasil hmac yang dikirimkan oleh klien.\nSetelah klien (ESP32) melakukan kalkulasi hmac dengan payload yang digunakan yaitu (unixTime,message) maka pesan akan dikirimkan kepada server beserta signature hmac yang telah dikalkulasi. Kemudian server akan menerima pesan yang diterima beserta signature yang dikirimkan oleh klien. Kemudian server mengkalkulasi sendiri hmac dari pesan yang diterima oleh klien menggunakan secret key yang dimiliki oleh server. JIka hasil signaturenya sama maka pesan yang diterima adalah pesan yang sesuai dan original, tidak diubah ubah oleh orang lain. Karena signaturenya sama. Tetapi jika pada saat dikirimkan terjadi perbedaan pesan atau signature maka hasil perhitungan hmac di server akan berbeda sehingga mengindikasikan bahwa pesan telah dilakukan perubahan pada saat pengiriman atau disebut MITM (Man in the middle) attack.\nReferensi\nhttps://docs.espressif.com/projects/esp-idf/en/latest/esp32s2/api-reference/peripherals/hmac.html\nhttps://mbed-tls.readthedocs.io/projects/api/en/development/api/file/md_8h/\n","wordCount":"358","inLanguage":"en","datePublished":"2023-08-14T07:49:00Z","dateModified":"2023-08-14T07:49:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://radito.github.io/posts/aa56eb07-4f2d-47b4-bb88-3b4bb72ca41d/"},"publisher":{"@type":"Organization","name":"Radito's Blog","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/radito/radito.github.io/main/assets/img/favicon.ico"}}}</script><script defer src=https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@latest/dist/cookieconsent.js></script>
<script>window.addEventListener("load",async function(){await new Promise(e=>setTimeout(e,3e3));var e=initCookieConsent();e.run({current_lang:"en",autoclear_cookies:!0,page_scripts:!0,onFirstAction:function(){},onAccept:function(){},onChange:function(){},languages:{en:{consent_modal:{title:"🍪 We use cookies!",description:'Hi, this website uses essential cookies to ensure its proper operation and tracking cookies to understand how you interact with it. The latter will be set only after consent. <button type="button" data-cc="c-settings" class="cc-link">Let me choose</button>',primary_btn:{text:"✅ Accept all",role:"accept_all"},secondary_btn:{text:"❌ Reject all",role:"accept_necessary"}},settings_modal:{title:"Cookie preferences",save_settings_btn:"Save settings",accept_all_btn:"Accept all",reject_all_btn:"Reject all",close_btn_label:"Close",cookie_table_headers:[{col1:"Name"},{col2:"Domain"},{col3:"Expiration"},{col4:"Description"}],blocks:[{title:"Cookie usage 📢",description:"I use cookies to ensure the basic functionalities of the website and to enhance your online experience. You can choose for each category to opt-in/out whenever you want."},{title:"Strictly necessary cookies",description:"These cookies are essential for the proper functioning of my website. Without these cookies, the website would not work properly",toggle:{value:"necessary",enabled:!0,readonly:!0}},{title:"Performance and Analytics cookies",description:"These cookies allow the website to remember the choices you have made in the past",toggle:{value:"analytics",enabled:!0,readonly:!1},cookie_table:[{col1:"^_ga",col2:"google.com",col3:"2 years",col4:"Google Analytics Cookie",is_regex:!0}]}]}}}})})</script><script>function setSyntaxMode(e){const t=document.querySelectorAll("pre.chroma");e=="dark"&&t.forEach((e)=>{e.classList.remove("theme-github-min"),e.classList.add("theme-github-dark-dimmed-min")}),e=="light"&&t.forEach((e)=>{e.classList.add("theme-github-min"),e.classList.remove("theme-github-dark-dimmed-min")})}</script><script>const currentLocal=localStorage.getItem("pref-theme");!currentLocal&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(localStorage.setItem("pref-theme","dark"),document.documentElement.classList.add("c_darkmode")),currentLocal=="dark"&&document.documentElement.classList.add("c_darkmode"),window.addEventListener("load",function(){document.getElementById("theme-toggle").addEventListener("click",async()=>{await new Promise(e=>setTimeout(e,100));const e=localStorage.getItem("pref-theme");setSyntaxMode(e),e=="dark"?document.documentElement.classList.add("c_darkmode"):document.documentElement.classList.remove("c_darkmode")})})</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://radito.github.io/ accesskey=h title="Radito's Blog (Alt + H)">Radito's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://radito.github.io/ title=Home><span>Home</span></a></li><li><a href=https://radito.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://radito.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><link rel=preload href=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.css as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.css><link href=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.js rel=preload as=script><script defer src=https://cdn.jsdelivr.net/npm/viewerjs@latest/dist/viewer.min.js></script>
<script type=application/ld+json class=reviews-schema data-ref=5885eb7006697bb79520c873373d1d8f>{"@context":"http://schema.org","@type":"Product","name":"Embed Social","aggregateRating":{"@type":"AggregateRating","ratingValue":"5","reviewCount":"100"}}</script><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://radito.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://radito.github.io/posts/>Posts</a></div><h1 class=post-title>🔐 Implementasi HMAC di ESP32 / ESP8266</h1><div class=post-meta><span title='2023-08-14 07:49:00 +0000 UTC'>August 14, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;358 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/radito/radito.github.io/blob/main/content/posts/aa56eb07-4f2d-47b4-bb88-3b4bb72ca41d.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Hash Message Authentication Code (HMAC) adalah sebuah kode yang digunakan untuk mengautentikasi keaslian pesan yang dikirimkan dari sebuah klien menuju server atau sebaliknya. HMAC. Pengguaan HMAC didasari dengan penggunaan Secret key yang disetujui antara klien dan server, serta payload adalah masukan yang digunakan untuk menghitung HASH hasil hmac.</p><p>Algoritma hash yang digunakan HMAC bervariasi, tetapi kebanyakan menggunakan algoritma SHA1 atau SHA256. Berikut ini adalah ilustrasi penggunaan HMAC antar klien dan server.</p><p><img loading=lazy src=https://radito.vercel.app/087475b723ef7a5f4b19ec1bec7c8dcd339dd2092199f7a76952a0a5227ca321/68747470733a2f2f7777772e64726f70626f782e636f6d2f73636c2f66692f6e73686636316c7063693871746b347132616e7a652f623830376561656162323636653433333333646430303538333634613363616633383734323837343061316136616532316530613862336661303465363361352e706e673f726c6b65793d30666c713761727534706573303063676464663838666b726726646c3d30267261773d31 alt></p><p>Contoh Implementasi HMAC di ESP32</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/md.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define HMAC_SECRET &#34;123456&#34;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>genHmac</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span> <span class=n>signature</span><span class=p>,</span> <span class=kt>char</span><span class=o>*</span> <span class=n>payload</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>byte</span> <span class=n>hmacResult</span><span class=p>[</span><span class=mi>20</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_context_t</span> <span class=n>ctx</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_type_t</span> <span class=n>md_type</span> <span class=o>=</span> <span class=n>MBEDTLS_MD_SHA1</span><span class=p>;</span> <span class=c1>// Algoritma Yang dipakai SHA 1
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>const</span> <span class=n>size_t</span> <span class=n>payloadLength</span> <span class=o>=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>payload</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>const</span> <span class=n>size_t</span> <span class=n>keyLength</span> <span class=o>=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>HMAC_SECRET</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_setup</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=n>mbedtls_md_info_from_type</span><span class=p>(</span><span class=n>md_type</span><span class=p>),</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_hmac_starts</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=n>HMAC_SECRET</span><span class=p>,</span> <span class=n>keyLength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_hmac_update</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=n>payload</span><span class=p>,</span> <span class=n>payloadLength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_hmac_finish</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=n>hmacResult</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>mbedtls_md_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>outDigest</span><span class=p>[</span><span class=mi>45</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>hmacResult</span><span class=p>);</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>str</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sprintf</span><span class=p>(</span><span class=n>str</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>hmacResult</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>outDigest</span><span class=p>[</span><span class=n>count</span><span class=p>]</span> <span class=o>=</span> <span class=n>str</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>outDigest</span><span class=p>[</span><span class=n>count</span><span class=p>]</span> <span class=o>=</span> <span class=n>str</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>outDigest</span><span class=p>[</span><span class=n>count</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>strcpy</span><span class=p>(</span><span class=n>signature</span><span class=p>,</span> <span class=n>outDigest</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>	<span class=kt>char</span><span class=o>*</span> <span class=n>hmacSignature</span><span class=p>[</span><span class=mi>45</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kt>char</span><span class=o>*</span> <span class=n>message</span> <span class=o>=</span> <span class=s>&#34;Hello World&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>char</span><span class=o>*</span> <span class=n>unixTime</span> <span class=o>=</span> <span class=s>&#34;1692003946&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kt>char</span> <span class=n>payload</span><span class=p>[</span><span class=mi>128</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>snprintf</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=s>&#34;%s,%s&#34;</span><span class=p>,</span> <span class=n>message</span><span class=p>,</span> <span class=n>unixTime</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>genHmac</span><span class=p>(</span><span class=o>&amp;</span><span class=n>hmacSignature</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>payload</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Generated HMAC :&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>hmacSignature</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Kode diatas menghasilkan kode hmac dengan menggunakan payload dan secret key yang sudah ditentukan. Antara Server dan Klien masing masing memiliki secret yang sama, secret ini di distribusikan melalui kanal yang aman atau melalui cara offline tidak menggunakan internet. Secret ini diperlukan untuk memvalidasi hasil hmac yang dikirimkan oleh klien.</p><p>Setelah klien (ESP32) melakukan kalkulasi hmac dengan payload yang digunakan yaitu (unixTime,message) maka pesan akan dikirimkan kepada server beserta signature hmac yang telah dikalkulasi. Kemudian server akan menerima pesan yang diterima beserta signature yang dikirimkan oleh klien. Kemudian server mengkalkulasi sendiri hmac dari pesan yang diterima oleh klien menggunakan secret key yang dimiliki oleh server. JIka hasil signaturenya sama maka pesan yang diterima adalah pesan yang sesuai dan original, tidak diubah ubah oleh orang lain. Karena signaturenya sama. Tetapi jika pada saat dikirimkan terjadi perbedaan pesan atau signature maka hasil perhitungan hmac di server akan berbeda sehingga mengindikasikan bahwa pesan telah dilakukan perubahan pada saat pengiriman atau disebut MITM (Man in the middle) attack.</p><p>Referensi</p><p><a href=https://docs.espressif.com/projects/esp-idf/en/latest/esp32s2/api-reference/peripherals/hmac.html>https://docs.espressif.com/projects/esp-idf/en/latest/esp32s2/api-reference/peripherals/hmac.html</a></p><p><a href=https://mbed-tls.readthedocs.io/projects/api/en/development/api/file/md_8h/>https://mbed-tls.readthedocs.io/projects/api/en/development/api/file/md_8h/</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://radito.github.io/posts/b396a73c-54cd-4f96-80c0-429fe568a363/><span class=title>« Prev</span><br><span>📶 Mengaktifkan Modem LTE di Router Bolt BL-100 (OpenWRT)</span></a>
<a class=next href=https://radito.github.io/posts/ae200cad-3ad0-4977-b86d-0d424669858f/><span class=title>Next »</span><br><span>✳️ Debugging Driver Modem LTE FW BL-100</span></a></nav></footer><div id=comments class=thin issue-term="Blog Post - 🔐 Implementasi HMAC di ESP32 / ESP8266" style="background-color:var(--code-bg);border:1px solid var(--border);border-radius:var(--radius);padding:0 1rem"><center><p style="margin:.5rem 0">Loading Comments ...</p></center></div></article><script>const utterances=document.createElement("script");utterances.src=`https://utteranc.es/client.js`,utterances.setAttribute("repo","radito/radito.github.io"),utterances.setAttribute("issue-term",""),utterances.setAttribute("theme",""),utterances.setAttribute("crossorigin","anonymous"),utterances.async=!0,window.addEventListener("load",function(){document.querySelectorAll("img").forEach((e)=>{const n=new Viewer(e,{movable:!1,navbar:!1,toolbar:!1,focus:!0,transition:!1});e.addEventListener("show",function(){document.getElementsByTagName("html")[0].style.overflow="hidden"}),e.addEventListener("hide",function(){document.getElementsByTagName("html")[0].style.overflow="scroll"})})}),document.getElementById("theme-toggle").addEventListener("click",async()=>{const e=localStorage.getItem("pref-theme"),t=document.querySelector(".utterances-frame");if(e=="light"?(setSyntaxMode("dark"),document.documentElement.classList.remove("c_darkmode")):(setSyntaxMode("light"),document.documentElement.classList.remove("c_darkmode"),document.documentElement.classList.add("c_darkmode")),t){const n={type:"set-theme",theme:e=="light"?"github-dark":"github-light"};t.contentWindow.postMessage(n,"https://utteranc.es")}}),window.onload=async()=>{const t=localStorage.getItem("pref-theme"),e=document.getElementById("comments"),n=e.getAttribute("issue-term");setSyntaxMode(t),e.innerHTML="",utterances.setAttribute("theme",`github-${t??"light"}`),utterances.setAttribute("issue-term",n),e.appendChild(utterances)}</script></main><footer class=footer><span>&copy; 2024 <a href=https://radito.github.io/>Radito's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>